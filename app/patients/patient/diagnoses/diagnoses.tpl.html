<div>
    <div class="block">
        <div class="block-header">
            <h2>Diagnoses</h2>
            <div class="block-header-buttons">
                <button ng-click="addDiagnosis()" class="btn btn-action" ng-show="patient.access == 'owner'">Add</button>
            </div>
        </div>
        <div class="block-content">
            <div class="nodata" ng-show="!diagnoses.length">
                No diagnoses recorded.
            </div>
            <div ng-repeat="diagnosis in diagnoses" cm-resource="diagnosis" remove-fn="removeDiagnosis(diagnosis)">
                <cm-display>
                    <div class="resource-controls">
                        <cm-edit-delete edit-enabled="false" delete-enabled="patient.access == 'owner'"></cm-edit-delete>
                    </div>
                    <div class="resource-block">
                        <a href ng-click="showDisorderModal(diagnosis.disorder)" class="highlight">{{ diagnosis.disorder.name }}</a>
                    </div>
                </cm-display>

                <cm-edit>
                    <div class="resource-block">
                        <div class="resource-block-element">
                            <label class="label-top resource-block-heading">Disorder</label>
                            <typeahead multi="false" options-fn="findDisorder(value)" token-chosen-fn="diagnosisChosen(token, diagnosis)" model="diagnosis.disorder" placeholder="What disorder does the patient have?"></typeahead>
                        </div>
                    </div>
                    <div class="resource-block">
                        <cm-save-cancel></cm-save-cancel>
                    </div>
                </cm-edit>
            </div>
        </div>
    </div>
</div>