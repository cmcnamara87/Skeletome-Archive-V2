<div>
    <div class="header">
        <div class="header-title">
            All Groups
        </div>
        <div class="header-search">
            <div class="search">
                <i class="icon icon-search"></i>
                <input type="text" placeholder="Search" ng-model="search"/>
                <ul class="search-results" ng-show="search.length">
                    <li class="search-result" ng-repeat="patient in patients | filter:search">
                        <a href="">
                            {{ patient.id }} - {{ patient.fullName() }}
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="header-buttons">
            <button class="btn btn-action" ng-click="showCreateGroup()">Create</button>
        </div>
    </div>


    <table class="table-content">
        <tr>
            <th>Name <i class="icon icon-sort-down"></i></th>
            <!--<th>Location</th>-->
            <th>Members</th>
            <th>Patients</th>
            <th></th>
        </tr>
        <tr ng-repeat="group in groups | filter:search">
            <!-- Groups -->
            <td class="col-md-7">
                <div style="margin-bottom: 7px">
                    <a href="#/group/{{ group.id }}">
                        <span ng-show="group.membership"><i class="icon icon-user"></i></span> {{ group.name }}
                    </a>
                </div>
                <div>
                    {{ group.description }}
                </div>
            </td>

            <!-- Locations -->
            <!--<td>-->
            <!--<a href="#/group/{{ membership.group.id }}">-->
            <!--{{ membership.group.location }}-->
            <!--</a>-->
            <!--</td>-->

            <!-- Members -->
            <td>
                <a href="#/group/{{ group.id }}/members">
                    <cm-facepile users="group.members" limit="5"></cm-facepile>
                </a>
            </td>

            <td>
                <a href="#/group/{{ group.id }}/patients">
                    {{ group.patient_count || "0" }}
                </a>
            </td>

            <td>
                <div class="btn-group pull-right">
                    <button type="button" class="btn btn-action btn-action-small dropdown-toggle" data-toggle="dropdown">
                        <i class="icon icon-angle-down"></i>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li ng-show="!group.membership"><a href="" ng-click="joinGroup(group)"><i class="icon icon-arrow-right"></i> Join</a></li>

                        <li ng-show="group.membership"><a href="" ng-click="showLeaveGroup(group)"><i class="icon icon-arrow-left"></i> Leave</a></li>
                    </ul>
                </div>
            </td>
        </tr>
    </table>


    <smodal name="leaveGroup">
        <div class="smodal-title">
            Leave Group
        </div>
        <div class="smodal-description" >
            Are you sure you want to leave this group?
        </div>
        <div class="smodal-buttons">
            <div class="pull-right">
                <button class="btn btn-action" ng-click="$close()">Cancel</button>
                <button class="btn btn-action btn-action-selected" ng-click="$close(); leaveGroup(groupToLeave)">Leave {{ groupToLeave.name }}</button>
            </div>
        </div>
    </smodal>

    <smodal name="createGroup">
        <div class="smodal-title">
            Create a Group
        </div>
        <div class="smodal-description" >
            Proin mattis ipsum sed euismod tempor. Sed pretium turpis ac malesuada suscipit. Sed mollis facilisis tortor, vel mattis elit blandit ac.
        </div>
        <div class="smodal-content">

            <table class="sform">
                <tr class="sform-row">
                    <td class="sform-label"><label for="group_name">Group Name</label></td>
                    <td>
                        <input type="text" id="group_name" class="full-width" placeholder="Group Name" ng-model="newGroup.name" required/>
                    </td>
                </tr>
                <tr class="sform-row">
                    <td class="sform-label">
                        <label for="description">Description</label>
                    </td>
                    <td>
                        <div class="sform-inputs">
                            <textarea id="description" placeholder="Description" ng-model="newGroup.description" class="full-width"></textarea>
                        </div>
                    </td>
                </tr>
                <tr class="sform-row">
                    <td class="sform-label"><label for="administrator">Administrator</label></td>
                    <td>
                        <typeahead multi="false" model="newGroup.administrator" options-fn="findUsers(value)" placeholder="Who is the administrator for the group?" id="administrator"></typeahead>
                    </td>
                </tr>
                <!--<tr class="sform-row">-->
                <!--<td class="sform-label"><label for="location">Location</label></td>-->
                <!--<td>-->
                <!--<typeahead multi="false" model="newGroup.location" options-fn="findUsers(value)" placeholder="Where is this group based?" id="location"></typeahead>-->
                <!--</td>-->
                <!--</tr>-->
                <tr class="sform-row">
                    <td>
                        <label for="members">Members</label>
                    </td>
                    <td>
                        <div class="sform-inputs">
                            <typeahead multi="true" model="newGroup.members" options-fn="findUsers(value)" placeholder="Who do you want to invite to this group?" id="members"></typeahead>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <div class="smodal-buttons">
            <div class="pull-right">
                <button class="btn btn-action" ng-click="$close()">Cancel</button>
                <button class="btn btn-action btn-action-selected" ng-click="createGroup(newGroup)">Create</button>
            </div>
        </div>

    </smodal>

</div>